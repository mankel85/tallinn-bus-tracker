<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöå Tallinn Bus Tracker - √ïilme</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            text-align: center;
        }

        .stop-name {
            font-size: 16px;
            color: #666;
            text-align: center;
            margin-bottom: 15px;
        }

        .current-time {
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 10px;
        }

        .bus-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .bus-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .route-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .route-number {
            background: #667eea;
            color: white;
            font-weight: 700;
            font-size: 18px;
            padding: 8px 15px;
            border-radius: 12px;
            min-width: 50px;
            text-align: center;
        }

        .next-times {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .time-chip {
            background: #f0f8ff;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }

        .time-chip.next {
            background: #667eea;
            color: white;
        }

        .destination {
            color: #666;
            font-size: 14px;
            margin-top: 8px;
            font-weight: 500;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            width: 500px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 5px;
        }

        .timetable {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 8px;
            margin-top: 15px;
        }

        .time-slot {
            background: #f8f9fa;
            padding: 8px;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
            font-size: 14px;
        }

        .time-slot.current-hour {
            background: #667eea;
            color: white;
        }

        .day-selector {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .day-btn {
            background: #f0f0f0;
            border: none;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .day-btn.active {
            background: #667eea;
            color: white;
        }

        .refresh-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 15px;
            width: 100%;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: #5a6fd8;
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .modal-content {
                padding: 20px;
                margin: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="title">üöå Tallinn Bus Tracker</div>
            <div class="stop-name">üìç √ïilme Bus Stop</div>
            <div class="current-time" id="currentTime"></div>
            <button class="refresh-btn" onclick="updateTimes()">üîÑ Refresh Times</button>
        </div>

        <div id="busCards"></div>
    </div>

    <!-- Modal for full timetable -->
    <div id="timetableModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Route Timetable</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div class="day-selector">
                <button class="day-btn active" onclick="selectDay('weekday')">Weekday</button>
                <button class="day-btn" onclick="selectDay('saturday')">Saturday</button>
                <button class="day-btn" onclick="selectDay('sunday')">Sunday</button>
            </div>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // Timetable data for each route from √ïilme stop
       const timetables = {
  3: {
    destination: "Vana-L√µuna ‚Üí Pelguranna",
    weekday: [
      "05:16","05:34","05:50",
      "06:06","06:18","06:30","06:42","06:53",
      "07:03","07:14","07:24","07:34","07:44","07:55",
      "08:07","08:19","08:31","08:43","08:55",
      "09:07","09:19","09:31","09:45",
      "10:00","10:15","10:30","10:45",
      "11:01","11:18","11:36","11:54",
      "12:12","12:30","12:48",
      "13:06","13:24","13:41","13:58",
      "14:15","14:31","14:46",
      "15:01","15:16","15:30","15:45","15:59",
      "16:12","16:25","16:36","16:47","16:57",
      "17:09","17:21","17:34","17:47",
      "18:00","18:14","18:28","18:42","18:56",
      "19:10","19:27","19:43",
      "20:00","20:16","20:33","20:50",
      "21:07","21:24","21:41","21:58",
      "22:15","22:33","22:51",
      "23:09","23:27","23:45"
    ],
    saturday: [
      "05:49","06:15","06:39","07:05","07:30","07:56","08:22","08:47",
      "09:10","09:32","09:52","10:11","10:29","10:46","11:03","11:20",
      "11:37","11:54","12:11","12:28","12:48","13:09","13:30","13:52",
      "14:09","14:26","14:43","15:00","15:17","15:34","15:51","16:08",
      "16:25","16:42","16:59","17:13","17:33","17:55","18:20","18:47",
      "19:14","19:40","20:07","20:33","20:59","21:22","21:52","22:18",
      "22:45","23:18","23:45"
    ],
    sunday: [
      "05:49","06:15","06:39","07:05","07:30","07:56","08:22","08:47",
      "09:10","09:32","09:52","10:11","10:29","10:46","11:03","11:20",
      "11:37","11:54","12:11","12:28","12:48","13:09","13:30","13:52",
      "14:09","14:26","14:43","15:00","15:17","15:34","15:51","16:08",
      "16:25","16:42","16:59","17:13","17:33","17:55","18:20","18:47",
      "19:14","19:40","20:07","20:33","20:59","21:22","21:52","22:18",
      "22:45","23:18","23:45"
    ]
  },

  16: {
    destination: "Tallinn-V√§ike ‚Üí V√§ike-√ïism√§e",
    weekday: [
      "05:51",
      "06:15","06:40","06:56",
      "07:11","07:26","07:41","07:56",
      "08:12","08:27","08:42","08:55",
      "09:08","09:21","09:34","09:47",
      "10:01","10:15","10:30","10:45","10:59",
      "11:13","11:27","11:41","11:55",
      "12:10","12:25","12:40","12:55",
      "13:10","13:25","13:40","13:55",
      "14:10","14:25","14:40","14:55",
      "15:10","15:25","15:40","15:55",
      "16:11","16:25","16:39","16:53",
      "17:08","17:22","17:35","17:48",
      "18:00","18:13","18:26","18:39","18:53",
      "19:07","19:22","19:37","19:52",
      "20:07","20:22","20:37","20:51",
      "21:03","21:17","21:32","21:48",
      "22:03","22:17","22:32","22:46",
      "23:03","23:22","23:41","00:00"
    ],
    saturday: [
      "05:45",
      "06:10","06:32","06:52",
      "07:13","07:33","07:52",
      "08:11","08:30","08:49",
      "09:09","09:30","09:47",
      "10:05","10:24","10:44",
      "11:01","11:18","11:35","11:50",
      "12:06","12:22","12:38","12:54",
      "13:10","13:28","13:46",
      "14:04","14:20","14:36","14:52",
      "15:07","15:22","15:37","15:53",
      "16:01","16:17","16:34","16:50",
      "17:06","17:22","17:38","17:55",
      "18:00","18:12","18:29","18:46",
      "19:03","19:20","19:39","19:58",
      "20:21","20:44",
      "21:09","21:33","21:57",
      "22:20","22:40",
      "23:01","23:22","23:42"
    ],
    sunday: [
      "06:41",
      "07:09","07:33","07:55",
      "08:20","08:43",
      "09:07","09:32","09:56",
      "10:20","10:44",
      "11:18","11:35","11:52",
      "12:09","12:26","12:42","12:57",
      "13:14","13:30","13:47",
      "15:12","15:28","15:45",
      "16:11","16:45",
      "17:06","17:22","17:38","17:55",
      "18:12","18:29",
      "19:13","19:33","19:55",
      "20:18","20:42",
      "21:06","21:27","21:47",
      "22:06","22:24","22:42",
      "23:02","23:21","23:41"
    ]
  },

  39: {
    destination: "Vana-L√µuna ‚Üí Liikuri",
    weekday: [
      "05:35",
      "06:05","06:35",
      "07:05","07:21","07:38","07:55",
      "08:12","08:29","08:46",
      "09:03","09:23","09:46",
      "10:09","10:32","10:55",
      "11:20","11:45",
      "12:15","12:45",
      "13:08","13:31","13:54",
      "14:17","14:40",
      "15:03","15:26","15:50",
      "16:15","16:27","16:40",
      "17:08","17:33",
      "18:00","18:29","18:57",
      "19:26","19:56",
      "20:26","20:55",
      "21:24","21:52",
      "22:21","22:50"
    ],
    saturday: [
      "06:02","06:56",
      "07:26","07:56",
      "08:26","08:58",
      "09:38",
      "10:18","10:51",
      "11:31",
      "12:18","12:34","12:50",
      "13:10","13:28","13:46",
      "14:04","14:20","14:36","14:52",
      "15:07","15:22","15:37","15:53",
      "16:08","16:24","16:39","16:55",
      "17:11","17:27","17:43",
      "18:00","18:17","18:34","18:54",
      "19:13","19:33","19:55",
      "20:18","20:42",
      "21:06","21:27","21:47",
      "22:06","22:24","22:42",
      "23:02","23:21","23:41",
      "00:01"
    ],
    sunday: [
      "08:16",
      "09:17",
      "10:20",
      "11:24",
      "12:29",
      "14:01",
      "15:08",
      "16:15",
      "17:20",
      "18:26"
    ]
  },

  73: {
    destination: "Vana-L√µuna ‚Üí Kopli",
    weekday: [
      "05:16","05:37","05:58",
      "06:14","06:27","06:39","06:50",
      "07:01","07:11","07:21","07:33","07:45","07:57",
      "08:09","08:21","08:34","08:47",
      "09:00","09:13","09:26","09:39","09:54",
      "10:10","10:26","10:43",
      "11:00","11:17","11:35","11:54",
      "12:13","12:32","12:51",
      "13:09","13:27","13:45",
      "14:03","14:21","14:35","14:48",
      "15:01","15:15","15:29","15:42","15:56",
      "16:10","16:23","16:36","16:49",
      "17:01","17:17","17:32","17:47",
      "18:01","18:17","18:33","18:50",
      "19:07","19:26","19:45",
      "20:04","20:23","20:42",
      "21:00","21:19","21:38","21:57",
      "22:16","22:37","22:58",
      "23:20","23:42"
    ],
    saturday: [
      "06:34","07:04","07:27","07:50","08:13","08:36","08:59","09:22",
      "09:45","10:08","10:26","10:42","10:58","11:20","11:36","11:50",
      "12:02","12:18","12:34","12:50","13:06","13:22","13:38","13:54",
      "14:10","14:26","14:42","14:58","15:18","15:38","15:54","16:10",
      "16:26","16:42","16:58","17:14","17:30","17:46","17:50","18:02",
      "18:18","18:34","18:50","19:08","19:32","19:56","20:19","20:44",
      "21:08","21:31","21:56","22:20","22:43","23:08","23:38"
    ],
    sunday: [
      "06:34","07:04","07:27","07:50","08:13","08:36","08:59","09:22",
      "09:45","10:08","10:26","10:42","10:58","11:20","11:36","11:50",
      "12:02","12:18","12:34","12:50","13:06","13:22","13:38","13:54",
      "14:10","14:26","14:42","14:58","15:18","15:38","15:54","16:10",
      "16:26","16:42","16:58","17:14","17:30","17:46","17:50","18:02",
      "18:18","18:34","18:50","19:08","19:32","19:56","20:19","20:44",
      "21:08","21:31","21:56","22:20","22:43","23:08","23:38"
    ]
  }
};



        let currentDay = 'weekday';

        function getCurrentTime() {
            return new Date();
        }

        function formatTime(date) {
            return date.toLocaleTimeString('en-GB', { 
                hour: '2-digit', 
                minute: '2-digit',
                second: '2-digit'
            });
        }

        function getDayType() {
            const now = new Date();
            const day = now.getDay();
            if (day === 0) return 'sunday';
            if (day === 6) return 'saturday';
            return 'weekday';
        }

        function getNextTimes(route, count = 3) {
            const now = getCurrentTime();
            const currentTimeStr = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
            const dayType = getDayType();
            const times = timetables[route][dayType];
            
            const upcomingTimes = times.filter(time => time > currentTimeStr);
            return upcomingTimes.slice(0, count);
        }

        function updateCurrentTime() {
            document.getElementById('currentTime').textContent = formatTime(getCurrentTime());
        }

        function createBusCard(route) {
            const nextTimes = getNextTimes(route);
            const destination = timetables[route].destination;
            
            return `
                <div class="bus-card" onclick="openModal(${route})">
                    <div class="route-header">
                        <div class="route-number">${route}</div>
                    </div>
                    <div class="destination">${destination}</div>
                    <div class="next-times">
                        ${nextTimes.map((time, index) => 
                            `<div class="time-chip ${index === 0 ? 'next' : ''}">${time}</div>`
                        ).join('')}
                        ${nextTimes.length === 0 ? '<div class="time-chip">No more buses today</div>' : ''}
                    </div>
                </div>
            `;
        }

        function updateTimes() {
            const busCards = document.getElementById('busCards');
            const routes = [3, 16, 39, 73];
            
            busCards.innerHTML = routes.map(route => createBusCard(route)).join('');
        }

        function openModal(route) {
            const modal = document.getElementById('timetableModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            
            modalTitle.textContent = `Route ${route} - ${timetables[route].destination}`;
            
            displayTimetable(route, currentDay);
            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('timetableModal').style.display = 'none';
        }

        function selectDay(day) {
            currentDay = day;
            document.querySelectorAll('.day-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Get the current route from modal title
            const modalTitle = document.getElementById('modalTitle').textContent;
            const route = parseInt(modalTitle.match(/Route (\d+)/)[1]);
            displayTimetable(route, day);
        }

        function displayTimetable(route, day) {
            const modalContent = document.getElementById('modalContent');
            const times = timetables[route][day];
            const now = getCurrentTime();
            const currentHour = now.getHours();
            
            modalContent.innerHTML = `
                <div class="timetable">
                    ${times.map(time => {
                        const hour = parseInt(time.split(':')[0]);
                        const isCurrentHour = hour === currentHour;
                        return `<div class="time-slot ${isCurrentHour ? 'current-hour' : ''}">${time}</div>`;
                    }).join('')}
                </div>
            `;
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('timetableModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Initialize the app
        function init() {
            updateCurrentTime();
            updateTimes();
            
            // Update time every second
            setInterval(updateCurrentTime, 1000);
            
            // Update bus times every minute
            setInterval(updateTimes, 60000);
        }

        // Start the app when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>






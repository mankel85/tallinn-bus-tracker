<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöå Tallinn Bus Tracker - √ïilme</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            text-align: center;
        }

        .stop-name {
            font-size: 16px;
            color: #666;
            text-align: center;
            margin-bottom: 15px;
        }

        .current-time {
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 10px;
        }

        .bus-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .bus-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .route-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .route-number {
            background: #667eea;
            color: white;
            font-weight: 700;
            font-size: 18px;
            padding: 8px 15px;
            border-radius: 12px;
            min-width: 50px;
            text-align: center;
        }

        .next-times {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .time-chip {
            background: #f0f8ff;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }

        .time-chip.next {
            background: #667eea;
            color: white;
        }

        .destination {
            color: #666;
            font-size: 14px;
            margin-top: 8px;
            font-weight: 500;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            width: 500px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 5px;
        }

        .timetable {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 8px;
            margin-top: 15px;
        }

        .time-slot {
            background: #f8f9fa;
            padding: 8px;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
            font-size: 14px;
        }

        .time-slot.current-hour {
            background: #667eea;
            color: white;
        }

        .day-selector {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .day-btn {
            background: #f0f0f0;
            border: none;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .day-btn.active {
            background: #667eea;
            color: white;
        }

        .refresh-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 15px;
            width: 100%;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: #5a6fd8;
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .modal-content {
                padding: 20px;
                margin: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="title">üöå Tallinn Bus Tracker</div>
            <div class="stop-name">üìç √ïilme Bus Stop</div>
            <div class="current-time" id="currentTime"></div>
            <button class="refresh-btn" onclick="updateTimes()">üîÑ Refresh Times</button>
        </div>

        <div id="busCards"></div>
    </div>

    <!-- Modal for full timetable -->
    <div id="timetableModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Route Timetable</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div class="day-selector">
                <button class="day-btn active" onclick="selectDay('weekday')">Weekday</button>
                <button class="day-btn" onclick="selectDay('saturday')">Saturday</button>
                <button class="day-btn" onclick="selectDay('sunday')">Sunday</button>
            </div>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // Timetable data for each route from √ïilme stop
        const timetables = {
    3: {
        destination: "Vana-L√µuna ‚Üí Pelguranna",
        weekday: ["05:16", "05:34", "05:50", "06:06", "06:18", "06:30", "06:42", "06:55", "07:03", "07:14", "07:24", "07:34", "07:44", "07:55", "08:07", "08:19", "08:31", "08:43", "08:55", "09:07", "09:19", "09:31", "09:45", "10:01", "10:15", "10:30", "10:44", "11:01", "11:20", "11:39", "11:58", "12:17", "12:36", "12:55", "13:14", "13:33", "13:52", "14:11", "14:29", "14:46", "15:01", "15:16", "15:29", "15:43", "15:56", "16:08", "16:20", "16:32", "16:44", "16:55", "17:09", "17:23", "17:37", "17:51", "18:05", "18:18", "18:31", "18:44", "18:58", "19:12", "19:27", "19:42", "20:00", "20:16", "20:33", "20:51", "21:09", "21:27", "21:45", "22:03", "22:20", "22:37", "22:55", "23:13", "23:30", "23:47"],
        saturday: ["05:49", "06:15", "06:39", "07:05", "07:30", "07:56", "08:22", "08:47", "09:10", "09:32", "09:56", "10:20", "10:44", "11:08", "11:32", "11:56", "12:20", "12:44", "13:08", "13:32", "13:56", "14:20", "14:44", "15:08", "15:32", "15:56", "16:20", "16:44", "17:08", "17:32", "17:55", "18:20", "18:45", "19:10", "19:35", "20:01", "20:27", "20:54", "21:20", "21:46", "22:13", "22:40", "23:08", "23:36"],
        sunday: ["05:49", "06:15", "06:39", "07:05", "07:30", "07:56", "08:22", "08:47", "09:10", "09:32", "09:56", "10:20", "10:44", "11:08", "11:32", "11:56", "12:20", "12:44", "13:08", "13:32", "13:56", "14:20", "14:44", "15:08", "15:32", "15:56", "16:20", "16:44", "17:08", "17:32", "17:55", "18:20", "18:45", "19:10", "19:35", "20:01", "20:27", "20:54", "21:20", "21:46", "22:13", "22:40", "23:08", "23:36"]
    },
    16: {
        destination: "Tallinn-V√§ike ‚Üí V√§ike-√ïism√§e",
        weekday: ["05:51", "06:15", "06:40", "07:11", "07:26", "07:42", "08:00", "08:12", "08:27", "08:41", "08:56", "09:11", "09:25", "09:40", "09:55", "10:10", "10:25", "10:40", "10:55", "11:13", "11:27", "11:41", "11:55", "12:10", "12:25", "12:40", "12:55", "13:10", "13:25", "13:40", "13:55", "14:10", "14:25", "14:40", "14:55", "15:10", "15:25", "15:40", "15:55", "16:10", "16:25", "16:40", "16:55", "17:10", "17:25", "17:40", "17:55", "18:10", "18:25", "18:40", "18:55", "19:10", "19:25", "19:40", "19:55", "20:10", "20:25", "20:40", "20:55", "21:10", "21:25", "21:40", "21:55", "22:10", "22:25", "22:40", "22:55", "23:10", "23:24", "23:42", "00:00"],
        saturday: ["05:45", "06:10", "06:32", "06:52", "07:13", "07:33", "07:53", "08:11", "08:30", "08:49", "09:08", "09:28", "09:48", "10:08", "10:28", "10:48", "11:08", "11:27", "11:44", "12:00", "12:18", "12:34", "12:50", "13:06", "13:24", "13:42", "14:00", "14:17", "14:34", "14:50", "15:05", "15:20", "15:35", "15:50", "16:05", "16:20", "16:36", "16:52", "17:08", "17:24", "17:40", "17:56", "18:13", "18:30", "18:47", "19:06", "19:25", "19:47", "20:09", "20:33", "20:57", "21:23", "21:42", "22:00", "22:17", "22:33", "22:50", "23:08", "23:26", "23:45", "00:04"],
        sunday: ["06:41", "07:09", "07:33", "07:55", "08:23", "08:50", "09:16", "09:42", "10:06", "10:34", "10:55", "11:14", "11:34", "11:52", "12:10", "12:28", "12:46", "13:04", "13:21", "13:39", "13:57", "14:15", "14:33", "14:51", "15:09", "15:27", "15:45", "16:03", "16:21", "16:39", "16:57", "17:15", "17:33", "17:51", "18:09", "18:27", "18:45", "19:03", "19:21", "19:39", "19:57", "20:15", "20:33", "20:51", "21:09", "21:27", "21:45", "22:03", "22:21", "22:39", "22:57", "23:15", "23:33", "23:51", "00:01"]
    },
    39: {
        destination: "Vana-L√µuna ‚Üí Liikuri",
        weekday: ["05:35", "06:05", "06:35", "07:05", "07:25", "07:55", "08:25", "08:55", "09:23", "09:46", "10:09", "10:32", "10:55", "11:20", "11:45", "12:13", "12:43", "13:06", "13:29", "13:52", "14:15", "14:40", "15:06", "15:26", "15:50", "16:15", "16:36", "16:59", "17:26", "17:55", "18:23", "18:52", "19:20", "19:51", "20:21", "20:50", "21:22", "21:50", "22:20", "22:50"],
        saturday: ["06:02", "06:56", "07:26", "07:56", "08:26", "08:58", "09:38", "10:18", "10:51", "11:31", "12:14", "12:46", "13:18", "13:50", "14:22", "14:54", "15:26", "15:58", "16:30", "17:02", "18:05", "19:27", "20:29", "21:25", "22:20", "23:13"],
        sunday: ["08:16", "09:17", "10:20", "11:24", "12:29", "14:01", "15:08", "16:15", "17:20", "18:26"]
    },
    73: {
        destination: "Vana-L√µuna ‚Üí Kopli",
        weekday: ["05:16", "05:37", "05:58", "06:14", "06:27", "06:39", "06:50", "07:01", "07:11", "07:21", "07:33", "07:45", "07:57", "08:09", "08:21", "08:34", "08:47", "09:01", "09:13", "09:26", "09:39", "09:52", "10:06", "10:22", "10:38", "10:55", "11:13", "11:30", "11:48", "12:05", "12:23", "12:41", "12:59", "13:17", "13:35", "13:53", "14:11", "14:29", "14:45", "15:01", "15:16", "15:29", "15:42", "15:56", "16:09", "16:22", "16:35", "16:48", "17:01", "17:14", "17:27", "17:42", "17:57", "18:14", "18:31", "18:48", "19:05", "19:22", "19:39", "19:56", "20:13", "20:30", "20:48", "21:05", "21:24", "21:43", "22:03", "22:24", "22:45", "23:08", "23:31"],
        saturday: ["06:34", "07:04", "07:27", "07:50", "08:13", "08:36", "08:59", "09:22", "09:45", "10:08", "10:32", "10:56", "11:20", "11:44", "12:08", "12:32", "12:56", "13:20", "13:44", "14:08", "14:32", "14:56", "15:20", "15:44", "16:08", "16:32", "16:56", "17:20", "17:44", "18:08", "18:32", "18:56", "19:20", "19:43", "20:06", "20:30", "20:53", "21:17", "21:40", "22:03", "22:27", "22:50", "23:13", "23:38"],
        sunday: ["06:34", "07:04", "07:27", "07:50", "08:13", "08:36", "08:59", "09:22", "09:45", "10:08", "10:32", "10:56", "11:20", "11:44", "12:08", "12:32", "12:56", "13:20", "13:44", "14:08", "14:32", "14:56", "15:20", "15:44", "16:08", "16:32", "16:56", "17:20", "17:44", "18:08", "18:32", "18:56", "19:20", "19:43", "20:06", "20:30", "20:53", "21:17", "21:40", "22:03", "22:27", "22:50", "23:13", "23:38"]
    }
};


        let currentDay = 'weekday';

        function getCurrentTime() {
            return new Date();
        }

        function formatTime(date) {
            return date.toLocaleTimeString('en-GB', { 
                hour: '2-digit', 
                minute: '2-digit',
                second: '2-digit'
            });
        }

        function getDayType() {
            const now = new Date();
            const day = now.getDay();
            if (day === 0) return 'sunday';
            if (day === 6) return 'saturday';
            return 'weekday';
        }

        function getNextTimes(route, count = 3) {
            const now = getCurrentTime();
            const currentTimeStr = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
            const dayType = getDayType();
            const times = timetables[route][dayType];
            
            const upcomingTimes = times.filter(time => time > currentTimeStr);
            return upcomingTimes.slice(0, count);
        }

        function updateCurrentTime() {
            document.getElementById('currentTime').textContent = formatTime(getCurrentTime());
        }

        function createBusCard(route) {
            const nextTimes = getNextTimes(route);
            const destination = timetables[route].destination;
            
            return `
                <div class="bus-card" onclick="openModal(${route})">
                    <div class="route-header">
                        <div class="route-number">${route}</div>
                    </div>
                    <div class="destination">${destination}</div>
                    <div class="next-times">
                        ${nextTimes.map((time, index) => 
                            `<div class="time-chip ${index === 0 ? 'next' : ''}">${time}</div>`
                        ).join('')}
                        ${nextTimes.length === 0 ? '<div class="time-chip">No more buses today</div>' : ''}
                    </div>
                </div>
            `;
        }

        function updateTimes() {
            const busCards = document.getElementById('busCards');
            const routes = [3, 16, 39, 73];
            
            busCards.innerHTML = routes.map(route => createBusCard(route)).join('');
        }

        function openModal(route) {
            const modal = document.getElementById('timetableModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            
            modalTitle.textContent = `Route ${route} - ${timetables[route].destination}`;
            
            displayTimetable(route, currentDay);
            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('timetableModal').style.display = 'none';
        }

        function selectDay(day) {
            currentDay = day;
            document.querySelectorAll('.day-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Get the current route from modal title
            const modalTitle = document.getElementById('modalTitle').textContent;
            const route = parseInt(modalTitle.match(/Route (\d+)/)[1]);
            displayTimetable(route, day);
        }

        function displayTimetable(route, day) {
            const modalContent = document.getElementById('modalContent');
            const times = timetables[route][day];
            const now = getCurrentTime();
            const currentHour = now.getHours();
            
            modalContent.innerHTML = `
                <div class="timetable">
                    ${times.map(time => {
                        const hour = parseInt(time.split(':')[0]);
                        const isCurrentHour = hour === currentHour;
                        return `<div class="time-slot ${isCurrentHour ? 'current-hour' : ''}">${time}</div>`;
                    }).join('')}
                </div>
            `;
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('timetableModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Initialize the app
        function init() {
            updateCurrentTime();
            updateTimes();
            
            // Update time every second
            setInterval(updateCurrentTime, 1000);
            
            // Update bus times every minute
            setInterval(updateTimes, 60000);
        }

        // Start the app when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>

